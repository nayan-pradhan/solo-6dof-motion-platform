# Software Framework

Our open-source software package uses the master-board from the SOLO robot [Open Dynamic Robot Initiative GitHub page](https://github.com/open-dynamic-robot-initiative) to send torque commands to the motors and read sensor data. The [master-board](https://github.com/open-dynamic-robot-initiative/master-board) centralises all the sensor and actuator data and provides wired and wireless connection to a real-time computer. 

The primary language used in our software package is Python3. The software framework is built to be modular such that any user may update, add, or remove parts of the module. As long as the modules receive an input csv file of the proper format and output the respective csv files of proper format, the software framework will work as designed. 

Our software framework consists of 4 main modules:
1. [Platform Trajectory Generation](#platform-trajectory-generation)
2. Inverse Kinematics Tool 
3. Control Environment
4. Post Processing

A flowchart showing a high-level overiew of the complete software framework is shown below:
<p align="center">
  <img src="../images/solo-6dof-motion-platform_framework.png" width="500"/>
</p>

<a name="platform-trajectory-generation"></a>

## 1. Platform Trajectory Generation
The Platform Trajectory Generation module generates the target position and target orientation of the platform. A csv file is auto-generated containing a sequence of tx, ty, tz, rx, ry, and rz for translation and rotation in x, y and z respectively. The sequence starts with an initial waiting time of 2 seconds where the platform stays stable in the home position. The sequence is generated for a frequency of $240$ Hz for the PyBullet control environment and $1000$ Hz for the SOLO robot control environment (more details in [Control Environment](#control_environment)). 

We have implemented the following options for trajectory generation: 
- <b>Sine Trajectory Generation:</b> The sine trajectory generation generates a sequence of platform target positions and orientations by taking in the run time for the sequence (seconds), the waiting time after the completion of the sequence (seconds), the direction of movement (x/y/z), the motion type (translation/rotation), the frequency of the sine wave (Hz), the amplitude of the sine wave (mm/deg), and offsets in x, y, and z (mm) axis in case the user wants to modify the axis of translation/rotation. A list of multiple sine sequence inputs can be specified by the user in the same input csv file. 
- <b>Arbitrary Trajectory Generation:</b> The arbitrary trajectory generation generates a sequence of platform target positions and orientations by taking in a sequence of target positions (mm), target orientations (deg), and interpolation times (seconds) with respect to the home position. The trajectory is generated by doing a smooth linear interpolation between the desired target positions and orientations with the specified time of interpolation.  
- <b>Step Trajectory Generation:</b> The step trajectory generation generates a sequence of platform target positions and orientations by taking in a single line of platform end target position (mm) and orientation (deg). The generated trajectory contains a sudden change (in 1 ms) in target position and orientation to generate a step function. This is can be used for tuning the controller. 
- <b>Circular Trajectory Generation:</b> The circular trajectory generation generates a sequence of platform target positions and orientations such that the platform translates and rotates in a circular movement by taking in the radius of translation (mm), the angle of rotation (deg), the number of rounds, the frequency of rotation in each round, the translation and rotation direction (clock-wise/counter-clock-wise), and a flag to enable and/or disable translation and rotation. 

The input parameters are given through CSV files located at: [`src/data_files/input_files/`](/src/data_files/input_files/).

### Notes   
- Smooth landing position is hard-coded (joint angles are pre-defined).  
- To give access of output history files to user, do 'sudo chown user:user \*' in data_files/\*/history/ directory.  